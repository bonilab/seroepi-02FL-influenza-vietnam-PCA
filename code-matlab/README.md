## README FILE FOR MATLAB CODE

The MATLAB scripts are numbered from S01 to S11 and should be run in this order to understand the analysis pipeline.

### SCRIPT 01 ("S01") 

This file reads in the titer data from 24,402 individuals into Matlab, performs the PCA, and saves the PCA matrices into the file 'mfb_workspace_titermatrix.mat'.

### SCRIPT 02 ("S02") 

This makes the density plot in Figure 3 of the main text.

### SCRIPT 03 ("S03") 

This makes age by PC1 plots for all ten locations.  Note that some locations have much fewer data points than others.  The last part of this script does the subtype-specific PCAs, which are then saved as Matlab variable to be read in by later scripts.

### SCRIPT 06 ("S06") 

This script takes the B matrices from the individual-based simulation and outputs a PC1-by-age matrix.  The B matrix is a simple matrix of titer values for 6700 individuals.

The script 06b allows you to see the age-PC1 plot of any particular simulation output.

### SCRIPT 07 ("S07") 

This script takes all of the age-PC1 files generated by script 06, performs attack rate inference on each age-PC1 file, and summarizes the results in a file that starts with "Inferred".

### SCRIPT 08 ("S08") 

This script summarizes the simulated versus the inferred attack rates and generates figures S2 and S3 in the supplementary materials.




